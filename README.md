
# Публикуйте комиксы во Telegram

Это приложение на Python, которое загружает комиксы в Telegram чат с помощью библиотеки telegram-python-bot.

## Структура приложения
Приложение состоит из двух файлов:
-  `bot.py`
-  `bot_helper.py`

### bot_helper.py:
- Функция `get_comic`: получает данные о комиксе с сайта.
- Функция `download_image`: скачивает изображение комикса.

###  bot.pу:
- Основная функция `main`: содержит настройки Telegram бота.
- Вспомогательные функции:
	+ `get_picture`: отправляет в чат комикс и удаляет изображение из папки `images`.
	+  `set_chat_id`: сохраняет chat_id в `.env` файл.
	+  `get_main_keyboard`: Возвращает клавиатуру с основными опциями.
	+  `get_random_comic`: Возвращает данные случайного комикса.
	+  `create_scheduler`: Создает и запускает поток для периодической отправки комиксов.
	+ `stop_previous_thread`: Останавливает поток для указанного чата, если он существует.
	+ `send_comic`: Отправляет один случайный комикс в указанный чат.
	+ `send_comic_periodically`: Периодическая отправка комиксов с возможностью остановки.
	+ `start`: Обработчик команды /start.
	+ `request_manual_input`: Запрашивает ручной ввод chat_id.
	+ `use_current_chat`: Использует текущий чат для отправки.
	+ `handle_manual_input`: Обрабатывает введенный вручную chat_id.
	+ `stop_bot`: Останавливает отправку комиксов.
- Функции обработки команд Telegram:
	+ /start - запуск бота и вывод меню выбора чата
	+ /stop - остановка рассылки в текущем чате


## Установка

### Зависимости
Для работы приложения необходимо установить зависимости из файла `requirements.txt`, который находится в корне проекта.
```bash
pip install -r requirements.txt
```
### Версия Python
Необходима версия Python 3.9 и выше.

### Телеграм Бот Токен
Для работы приложения необходимо получить токен для вашего Telegram бота. Создайте файл `.env` в корне приложения и добавьте переменную:

```ini
TELEGRAM_TOKEN='ВАШ ТЕЛЕГРАМ ТОКЕН'
```
(Опционально) Если вы знаете ID чата, куда бот должен отправлять комиксы, добавьте его в  `.env`:
```ini
TG_CHAT_ID='ID_ВАШЕГО_ЧАТА'
```

## Запуск приложения
Для запуска приложения выполните команду:
```bash
python bot.py
```
## Использование
1.  После запуска бота, начните с ним диалог в личных сообщениях или добавьте в группу
2.  Отправьте команду  `/start`  для вывода меню
3.  Выберите один из вариантов:
    
    -   **Выбрать данный чат для получения комиксов**  - текущий чат (где вы отправили команду) будет использован для рассылки
        
    -   **Ввести вручную id чата для отправки комиксов**  - введите ID чата, куда бот должен отправлять комиксы
        
4.  Бот начнет отправлять случайные комиксы каждый час
  
### Остановка рассылки
Отправьте команду  `/stop`  в чат, где идет рассылка, чтобы остановить отправку комиксов

## Примечания
-   Бот должен быть администратором в канале (если используется канал) или участником группы, чтобы отправлять сообщения
-   Для получения ID чата (особенно для каналов и групп) можно воспользоваться ботом  [@userinfobot](https://t.me/userinfobot)  или другими подобными ботами
-   Рассылка будет продолжаться до остановки бота или команды  `/stop`